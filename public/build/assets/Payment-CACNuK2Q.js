import{r as t,a as K,j as e,b as R}from"./app-Cj5o-eg-.js";import{S as $,H as A}from"./Header_Dashboard-BokXVhxZ.js";import{c as E}from"./x-DenSywY0.js";import{P as j,C as G}from"./package-FUDH6Kl3.js";import"./search-Dg7V2K9j.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],J=E("credit-card",H);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],C=E("shield",U),se=()=>{const[F,N]=t.useState(!1),{user:k,currentService:z,notifications:v=3,messages:_=2}=K().props,a=z||{id:1,name:"Logo Design â€” Basic Pack",description:"Professional logo design with 3 concepts and unlimited revisions",freelancer:"Ana Silva",deliveryTime:"5 business days",price:250,serviceFee:15},[p,w]=t.useState(""),[S,c]=t.useState(!1),[f,I]=t.useState(null),[D,M]=t.useState(null),[o,L]=t.useState(null),[u,O]=t.useState(null),[h,V]=t.useState(null),[y,r]=t.useState(""),[m,B]=t.useState(!1);t.useEffect(()=>{const x=async()=>{const n=stripePublicKey||"pk_test_51QUMErDgYV6zJ17v6MyFnaLZiK7jllm3Lsdq1OmxVbWZowVAWaoOy9CDjrde2byDyiPmaJ6xudcpPkpGsH7Oo0RU00mavjYxpt";try{if(typeof window<"u")if(window.Stripe){const s=window.Stripe(n);s&&i(s)}else{const s=document.createElement("script");s.src="https://js.stripe.com/v3/",s.onload=()=>{var d;try{const l=(d=window.Stripe)==null?void 0:d.call(window,n);if(l)i(l);else throw new Error("Failed to initialize Stripe instance")}catch(l){console.error("Error initializing Stripe:",l),r("Failed to initialize payment system. Please refresh the page.")}},s.onerror=()=>{r("Failed to load payment system. Please check your internet connection.")},document.head.appendChild(s)}}catch(s){console.error("Error loading Stripe:",s),r("Failed to initialize payment system.")}},i=n=>{I(n);const s=n.elements({appearance:{theme:"stripe",variables:{colorPrimary:"#7c3aed",colorBackground:"#ffffff",colorText:"#374151",colorDanger:"#ef4444",fontFamily:"system-ui, sans-serif",fontSizeBase:"16px",spacingUnit:"4px",borderRadius:"12px"},rules:{".Input":{padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:"12px",backgroundColor:"#ffffff",boxShadow:"none"},".Input:focus":{outline:"none",borderColor:"#7c3aed",boxShadow:"0 0 0 3px rgba(124, 58, 237, 0.1)"},".Input--invalid":{borderColor:"#ef4444"}}}});M(s);const d=s.create("cardNumber",{placeholder:"1234 5678 9012 3456",style:{base:{fontSize:"16px",color:"#374151",fontFamily:"system-ui, sans-serif","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444"}}}),l=s.create("cardExpiry",{placeholder:"MM/YY",style:{base:{fontSize:"16px",color:"#374151",fontFamily:"system-ui, sans-serif","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444"}}}),b=s.create("cardCvc",{placeholder:"123",style:{base:{fontSize:"16px",color:"#374151",fontFamily:"system-ui, sans-serif","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444"}}});d.mount("#card-number-element"),l.mount("#card-expiry-element"),b.mount("#card-cvc-element"),L(d),O(l),V(b);const g=({error:P})=>{r(P?P.message:"")};d.on("change",g),l.on("change",g),b.on("change",g),B(!0)};return x(),()=>{o&&o.unmount(),u&&u.unmount(),h&&h.unmount()}},[stripePublicKey]);const T=async x=>{if(x.preventDefault(),!f||!D||!o||!m){r("Payment system is not ready. Please wait or refresh the page.");return}if(!p.trim()){r("Please enter the cardholder name");return}c(!0),r("");try{const{error:i,paymentMethod:n}=await f.createPaymentMethod({type:"card",card:o,billing_details:{name:p.trim()}});if(i){console.error("Stripe error:",i),r(i.message||"Payment failed. Please try again."),c(!1);return}if(!n){r("Failed to create payment method. Please try again."),c(!1);return}R.post("/payment/process",{service_id:a.id,payment_method_id:n.id,card_name:p.trim()},{onSuccess:s=>{c(!1),w(""),o&&o.clear(),u&&u.clear(),h&&h.clear()},onError:s=>{c(!1),console.error("Payment backend error:",s),s.error?r(s.error):s.message?r(s.message):r("Payment failed. Please try again.")}})}catch(i){console.error("Payment processing error:",i),c(!1),r(i.message||"An unexpected error occurred. Please try again.")}},Y=a.price+a.serviceFee;return e.jsxs("div",{className:"flex ",children:[e.jsx($,{notifications:v,isOpen:F,setIsOpen:N}),e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{user:k,notifications:v,messages:_,onMenuButtonClick:()=>N(!0)}),e.jsx("main",{className:"flex-1 p-4 sm:p-6 lg:p-8",role:"main",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Finalizar Pedido"}),e.jsx("p",{className:"text-gray-600",children:"Complete your payment to start working with your selected freelancer"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(J,{className:"h-6 w-6 text-purple-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Card Payment"})]}),!m&&!y&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-600",children:"Loading payment system..."})}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:y})}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 ",children:"Card Number"}),e.jsx("div",{id:"card-number-element",className:"w-full border border-gray-300 rounded-xl focus-within:ring-2 focus-within:ring-purple-500 focus-within:border-purple-500 transition-colors min-h-[48px]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cardholderName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cardholder Name"}),e.jsx("input",{id:"cardholderName",type:"text",placeholder:"John Doe",value:p,onChange:x=>w(x.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors",required:!0,disabled:!m})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date"}),e.jsx("div",{id:"card-expiry-element",className:"w-full border border-gray-300 rounded-xl focus-within:ring-2 focus-within:ring-purple-500 focus-within:border-purple-500 transition-colors min-h-[48px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV"}),e.jsx("div",{id:"card-cvc-element",className:"w-full border border-gray-300 rounded-xl focus-within:ring-2 focus-within:ring-purple-500 focus-within:border-purple-500 transition-colors min-h-[48px]"})]})]}),e.jsx("button",{type:"submit",disabled:S||!f||!m,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-semibold py-4 px-6 rounded-xl transition-colors duration-200 flex items-center justify-center",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):m?"Confirmar e Pagar":"Loading..."})]}),e.jsxs("div",{className:"mt-6 flex items-center text-sm text-gray-500",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Your payment information is encrypted and secure"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(j,{className:"h-6 w-6 text-purple-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Order Summary"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mr-4",children:e.jsx(j,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Services"}),e.jsx("p",{className:"text-gray-700 font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.description})]})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Freelancer"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.freelancer})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Delivery Time"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.deliveryTime})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Service Price"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",a.price.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Service Fee"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["$",a.serviceFee.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total"}),e.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:["$",Y.toFixed(2)]})]})})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Money Back Guarantee"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Get a full refund if you're not satisfied with the work"})]})]})})]})]})]})]})})]})]})};export{se as default};
